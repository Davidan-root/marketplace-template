// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client-js"
  
}

datasource db {
  provider = "postgresql"
  
}

model Usuario {
  id                BigInt        @id @default(autoincrement())
  direccionUsuario  String
  email             String        @unique
  nombreUsuario     String
  numeroContacto    String
  passwordHash      String
  estadoUsuarioId   BigInt
  estadoUsuario     EstadoUsuario @relation(fields: [estadoUsuarioId], references: [id])
  vendedor          Vendedor?
  carritos          Carrito[]
  pedidos           Pedido[]

  @@map("usuario")
}

model EstadoUsuario {
  id            BigInt    @id @default(autoincrement())
  descripcionEU String
  nombreEU      String
  usuarios      Usuario[]

  @@map("estado_usuario")
}

model Vendedor {
  id               BigInt         @id @default(autoincrement())
  nombreTienda     String
  reputacion       Float         @default(0)
  usuarioId        BigInt         @unique
  usuario          Usuario        @relation(fields: [usuarioId], references: [id])
  estadoVendedorId BigInt
  estadoVendedor   EstadoVendedor @relation(fields: [estadoVendedorId], references: [id])
  publicaciones     Publicacion[]

  @@map("vendedor")
}

model EstadoVendedor {
  id            BigInt    @id @default(autoincrement())
  descripcionEV String
  nombreEV      String
  vendedores    Vendedor[]

  @@map("estado_vendedor")
}

model Publicacion {
  id               BigInt       @id @default(autoincrement())
  condicionesVenta String
  enviosVenta      Boolean
  precioVenta      Float
  stockVenta       Int
  vendedorId       BigInt
  vendedor         Vendedor     @relation(fields: [vendedorId], references: [id])
  productoId       BigInt
  producto         Producto     @relation(fields: [productoId], references: [id])
  carritoItems     CarritoItem[]
  pedidoItems      PedidoItem[]

  @@map("publicacion")
}

model Producto {
  id                  BigInt      @id @default(autoincrement())
  descripcionProducto String
  nombreProducto      String
  categoriaId         BigInt
  categoria           Categoria   @relation(fields: [categoriaId], references: [id])
  publicaciones       Publicacion[]
  resenas             Resena[]

  @@map("producto")
}

model Categoria {
  id                   BigInt    @id @default(autoincrement())
  descripcionCategoria String
  nombreCategoria      String
  productos            Producto[]

  @@map("categoria")
}

model Carrito {
  id                    BigInt      @id @default(autoincrement())
  fechaHoraAlta         DateTime     @default(now())
  fechaHoraBaja         DateTime?
  fechaHoraModificacion DateTime?
  usuarioId             BigInt
  usuario               Usuario     @relation(fields: [usuarioId], references: [id])
  carritoItems          CarritoItem[]

  @@map("carrito")
}

model CarritoItem {
  id            BigInt      @id @default(autoincrement())
  cantidadCI    Int
  carritoId     BigInt
  carrito       Carrito     @relation(fields: [carritoId], references: [id])
  publicacionId BigInt
  publicacion   Publicacion @relation(fields: [publicacionId], references: [id])

  @@map("carrito_item")
}

model Pedido {
  id            BigInt     @id @default(autoincrement())
  fechaHoraAlta DateTime   @default(now())
  numeroPedido  Int        @unique
  totalPrecio   Float
  usuarioId     BigInt
  usuario       Usuario    @relation(fields: [usuarioId], references: [id])
  pedidoItems   PedidoItem[]
  pagos         Pago[]
  envio         Envio?

  @@map("pedido")
}

model PedidoItem {
  id             BigInt      @id @default(autoincrement())
  cantidadPI     Int
  precioUnitario Float
  subtotalPI     Float
  pedidoId       BigInt
  pedido         Pedido      @relation(fields: [pedidoId], references: [id])
  publicacionId  BigInt
  publicacion    Publicacion @relation(fields: [publicacionId], references: [id])

  @@map("pedido_item")
}

model Pago {
  id         BigInt @id @default(autoincrement())
  metodoPago String
  monto      Float
  pedidoId   BigInt
  pedido     Pedido @relation(fields: [pedidoId], references: [id])

  @@map("pago")
}

model Envio {
  id          BigInt @id @default(autoincrement())
  estadoEnvio String
  numeroEnvio Int
  pedidoId    BigInt @unique
  pedido      Pedido @relation(fields: [pedidoId], references: [id])

  @@map("envio")
}

model Resena {
  id            BigInt   @id @default(autoincrement())
  comentario    String
  fechaHoraAlta DateTime @default(now())
  puntaje       Int
  productoId    BigInt
  producto      Producto @relation(fields: [productoId], references: [id])

  @@map("resena")
}